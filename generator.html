<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SmartCV — Checkout</title>
  <link rel="stylesheet" href="style.css?v=2025-11-02" />
  <!-- libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js" defer></script>
  <!-- IMPORTANT: keep your LIVE Client ID here -->
  <script src="https://www.paypal.com/sdk/js?client-id=LIVE_CLIENT_ID_HERE&currency=CAD" defer></script>
  <!-- app -->
  <script src="script.js?v=2025-11-02" defer></script>
</head>
<body class="dark">
  <header class="site-header">
    <h1>SmartCV — Checkout</h1>
  </header>

  <main class="container">
    <section class="card">
      <h2>1) Style</h2>
      <div id="chosen" class="chosen">Style: <span id="tplName">—</span> • Price: <span id="tplPrice">—</span> CAD</div>
      <div id="missingTpl" class="small" style="display:none;margin-top:6px;">
        Tip: open from <a href="index.html">styles list</a> or add <code>?template=creative</code> to the URL.
      </div>
    </section>

    <section class="card">
      <h2>2) Language</h2>
      <div class="grid two">
        <label>Form language
          <select id="uiLang">
            <option value="en" selected>English</option>
            <option value="fr">Français</option>
            <option value="es">Español</option>
            <option value="ar">العربية</option>
            <option value="zh">中文</option>
            <option value="hi">हिन्दी / ਪੰਜਾਬੀ</option>
            <option value="tl">Tagalog</option>
            <option value="pt">Português</option>
            <option value="ru">Русский</option>
            <option value="uk">Українська</option>
          </select>
        </label>
        <label>Resume language
          <select id="cvLang">
            <option value="en" selected>English</option>
            <option value="fr">Français</option>
          </select>
        </label>
      </div>
    </section>

    <section class="card">
      <h2>3) Your info</h2>
      <form id="cvForm">
        <div class="grid two">
          <label data-i18n="fullName">Full Name
            <input name="fullName" type="text" placeholder="John Smith" required />
          </label>
          <label data-i18n="jobTitle">Job Title
            <input name="title" type="text" placeholder="Welder / Construction Worker" required />
          </label>
        </div>
        <div class="grid two">
          <label data-i18n="email">Email (for receiving files)
            <input name="email" type="email" placeholder="you@example.com" required />
          </label>
          <label data-i18n="phone">Phone
            <input name="phone" type="tel" placeholder="+1 (555) 000-0000" required />
          </label>
        </div>
        <label data-i18n="location">City, Province / State
          <input name="location" type="text" placeholder="London, ON" required />
        </label>

        <div class="grid two">
          <label data-i18n="purpose">Resume purpose
            <select name="purpose" id="purpose">
              <option value="factory">Factory worker</option>
              <option value="construction">Construction worker</option>
              <option value="mechanic">Mechanic</option>
              <option value="other">Other</option>
            </select>
          </label>
          <label data-i18n="subsector">Specialization / trade
            <select name="subsector" id="subsector">
              <option value="">—</option>
            </select>
          </label>
        </div>

        <label>About Me
          <textarea name="summary" rows="4" placeholder="Short summary about you"></textarea>
        </label>
        <label>Work Experience
          <textarea name="experience" rows="4" placeholder="Company, role, dates, achievements"></textarea>
        </label>
        <label>Education
          <textarea name="education" rows="3" placeholder="School, program, dates"></textarea>
        </label>
        <label>Skills (semicolon ; separated)
          <input name="skills" type="text" placeholder="Teamwork; Time management; Basic tools" />
        </label>
      </form>
    </section>

    <section class="card">
      <h2>4) Payment</h2>
      <div id="paypal-buttons"></div>
      <input id="paypal-amount" type="hidden" value="0.00" />
      <p class="small">After payment, your PDF will download automatically.</p>
    </section>
  </main>

  <div id="toast"></div>
  <footer class="wrap"><p>© SmartCV</p></footer>
  <!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=AS7osnEOQzqtoyPlMENRJTfU1j-PvwmsXEAkqwCkZw4yItf0Z35RV8YDiyjkw2XDMPbcfgDGJJ5NIfWA&components=buttons&currency=CAD&enable-funding=card"></script>

<script>
paypal.Buttons().render('#paypal-buttons');
</script>
  <script>
(function() {
  // Ціни для кожної версії
  const PRICE = {
    professional: 4.99,
    creative: 9.99,
    vippack: 59.99,
    funny: 2.00,
    romantic: 2.00,
    apology: 2.00,
    entertaining: 3.00
  };

  // Беремо параметр з URL (наприклад ?plan=creative)
  const url = new URL(window.location.href);
  const plan = url.searchParams.get("plan")?.toLowerCase() || "professional";
  const amount = PRICE[plan] ?? 4.99; // за замовчуванням 4.99

  // Прописуємо суму в PayPal
  const input = document.getElementById("paypal-amount");
  if (input) input.value = amount.toFixed(2);

  // Створюємо кнопку
  paypal.Buttons({
    createOrder: (data, actions) => {
      return actions.order.create({
        purchase_units: [{ amount: { value: amount.toFixed(2), currency_code: "CAD" } }]
      });
    },
    onApprove: (data, actions) => {
      return actions.order.capture().then(() => {
        alert(`Оплата успішна — ${amount.toFixed(2)} CAD`);
        // тут запускається твій PDF
        window.generatePDF && window.generatePDF();
      });
    }
  }).render("#paypal-buttons");
})();
</script>
</body>
</html>
